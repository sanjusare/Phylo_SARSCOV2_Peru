intr_arg_ap_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Argentina"&
loc2=="Peru")%>%
dplyr::filter(height2==max(height2))
intr_arg_ac_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Argentina"&
loc2=="Chile")%>%
dplyr::filter(height2==max(height2))
intr_arg_pa_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Peru"&
loc2=="Argentina")%>%
dplyr::filter(height2==max(height2))
intr_arg_pc_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Peru"&
loc2=="Chile")%>%
dplyr::filter(height2==max(height2))
intr_arg_cp_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Chile"&
loc2=="Peru")%>%
dplyr::filter(height2==max(height2))
intr_arg_ca_list[[x]]<-dats_trees_list[[x]][[2]]%>%
dplyr::group_by(tree)%>%
dplyr::filter(locroot=="Argentina"&
loc1=="Chile"&
loc2=="Argentina")%>%
dplyr::filter(height2==max(height2))
}
intr_per_ap<-do.call(rbind,intr_per_ap_list)
intr_per_ac<-do.call(rbind,intr_per_ac_list)
intr_per_pa<-do.call(rbind,intr_per_pa_list)
intr_per_pc<-do.call(rbind,intr_per_pc_list)
intr_per_cp<-do.call(rbind,intr_per_cp_list)
intr_per_ca<-do.call(rbind,intr_per_ca_list)
intr_arg_ap<-do.call(rbind,intr_arg_ap_list)
intr_arg_ac<-do.call(rbind,intr_arg_ac_list)
intr_arg_pa<-do.call(rbind,intr_arg_pa_list)
intr_arg_pc<-do.call(rbind,intr_arg_pc_list)
intr_arg_cp<-do.call(rbind,intr_arg_cp_list)
intr_arg_ca<-do.call(rbind,intr_arg_ca_list)
intr_1st_all<-do.call(rbind,list(intr_per_ap,intr_per_ac,intr_per_pa,intr_per_pc,intr_per_cp,intr_per_ca,intr_arg_ap,intr_arg_ac,intr_arg_pa,intr_arg_pc,intr_arg_cp,intr_arg_ca))%>%
dplyr::mutate(trans=paste(loc1,"to",loc2))
intr_1st_all$locroot<-factor(intr_1st_all$locroot,levels=c("Peru","Argentina"),ordered=T)
p_trans_pe<-ggplot(subset(intr_1st_all,locroot=="Peru"&trans=="Peru to Argentina"|locroot=="Peru"&trans=="Peru to Chile"),aes(x=as.POSIXct(date2),fill=loc2))+
geom_histogram(alpha=0.5,position=position_dodge(),bins=56)+
scale_fill_manual(values=count_colors[names(count_colors)%in%levels(as.factor(intr_1st_all$loc2))],
labels=c("Peru to Argentina","Peru to Chile","Agentina to Peru"))+
labs(y="Number of trees")+
theme(legend.position="none",
axis.title.x=element_blank(),
axis.text.x=element_text(angle=90,hjust=0,vjust=0))+
scale_y_continuous(position="right",limits=c(0,60))+
scale_x_datetime(date_breaks="1 month",date_labels="%Y-%b",limits=c(as.POSIXct("2020-05-01"),as.POSIXct("2021-02-28")))+
geom_vline(data=filter(intr_1st_all,locroot=="Peru"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Argentina"&intr_1st_all$locroot=="Peru"],probs=c(0.05),type=1)[1])),color="blue",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Peru"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Argentina"&intr_1st_all$locroot=="Peru"],probs=c(0.95),type=1)[1])),color="blue",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Peru"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Chile"&intr_1st_all$locroot=="Peru"],probs=c(0.05),type=1)[1])),color="darkgreen",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Peru"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Chile"&intr_1st_all$locroot=="Peru"],probs=c(0.95),type=1)[1])),color="darkgreen",size=1,alpha=0.2)
p_trans_ar<-ggplot(subset(intr_1st_all,locroot=="Argentina"&trans=="Argentina to Peru"|locroot=="Argentina"&trans=="Peru to Chile"),aes(x=as.POSIXct(date2),fill=loc2))+
geom_histogram(alpha=0.5,position=position_dodge(),bins=56)+
scale_fill_manual(values=count_colors[names(count_colors)%in%levels(as.factor(intr_1st_all$loc2))],
labels=c("Peru to Argentina","Peru to Chile","Agentina to Peru"))+
labs(y="Number of trees")+
theme(legend.position="none",
axis.title.x=element_blank(),
axis.text.x=element_text(angle=90,hjust=0,vjust=0))+
scale_y_continuous(position="right",limits=c(0,60))+
scale_x_datetime(date_breaks="1 month",date_labels="%Y-%b",limits=c(as.POSIXct("2020-05-01"),as.POSIXct("2021-02-28")))+
geom_vline(data=filter(intr_1st_all,locroot=="Argentina"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Argentina to Peru"&intr_1st_all$locroot=="Argentina"],probs=c(0.05),type=1)[1])),color="darkred",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Argentina"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Argentina to Peru"&intr_1st_all$locroot=="Argentina"],probs=c(0.95),type=1)[1])),color="darkred",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Argentina"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Chile"&intr_1st_all$locroot=="Argentina"],probs=c(0.05),type=1)[1])),color="darkgreen",size=1,alpha=0.2)+
geom_vline(data=filter(intr_1st_all,locroot=="Argentina"),aes(xintercept=as.POSIXct(quantile(intr_1st_all$date2[intr_1st_all$trans=="Peru to Chile"&intr_1st_all$locroot=="Argentina"],probs=c(0.95),type=1)[1])),color="darkgreen",size=1,alpha=0.2)
p_trans<-ggarrange(p_trans_pe,p_trans_ar,ncol=1,nrow=2)
coord<-read.csv(args[3],sep="\t",header=FALSE)
names(coord)<-c("Country","longitude","latitude")
map_sum<-intr_1st_all%>%
dplyr::group_by(loc1,loc2,locroot,trans)%>%
dplyr::summarise(med_date1=median(date1),
med_date2=median(date2),
q05date2=quantile(date2,probs=0.05,type=1),
q95date2=quantile(date2,probs=0.95,type=1))%>%
dplyr::left_join(coord,by=c("loc1"="Country"))%>%
dplyr::mutate(lat1=latitude,
lon1=longitude)%>%
dplyr::select(!c(latitude,longitude))%>%
dplyr::left_join(coord,by=c("loc2"="Country"))%>%
dplyr::mutate(lat2=latitude,
lon2=longitude)%>%
dplyr::select(!c(latitude,longitude))
thismap<-map_data("world")
thismap$fill<-"lightgrey"
thismap$fill[thismap$region=="Peru"]<-'"firebrick"'
thismap$fill[thismap$region=="Argentina"]<-'"dodgerblue"'
thismap$fill[thismap$region=="Chile"]<-'"forestgreen"'
world1<-ggplot(thismap,aes(long,lat))+
geom_polygon(aes(group=group,fill=fill),color="lightgrey",alpha=0.5)+
scale_fill_manual(values=c("dodgerblue","firebrick","forestgreen","grey"))+
coord_cartesian(ylim=c(-55,0),
xlim=c(-80,-55))+
geom_curve(data=subset(map_sum,locroot=="Peru"&trans%in%c("Peru to Chile")),
aes(x=lat1,y=lon1,
xend=lat2,yend=lon2),
curvature=-0.7,
size=1,
arrow=arrow(length=unit(0.1,"inches")),
color="darkgreen")+
geom_curve(data=subset(map_sum,locroot=="Peru"&trans%in%c("Peru to Argentina")),
aes(x=lat1,y=lon1,
xend=lat2,yend=lon2),
curvature=-0.7,
size=1,
arrow=arrow(length=unit(0.1,"inches")),
color="blue")+
geom_label(data=coord,aes(x=latitude,y=longitude,label=Country),nudge_y=-5,alpha=0.5,size=3,label.padding=unit(0.1,"lines"))+
theme_map()+
theme(legend.position="none")
world2<-ggplot(thismap,aes(long,lat))+
geom_polygon(aes(group=group,fill=fill),color="lightgrey",alpha=0.5)+
scale_fill_manual(values=c("dodgerblue","firebrick","forestgreen","grey"))+
coord_cartesian(ylim=c(-55,0),
xlim=c(-80,-55))+
geom_curve(data=subset(map_sum,locroot=="Argentina"&trans%in%c("Peru to Chile")),
aes(x=lat1,y=lon1,
xend=lat2,yend=lon2),
curvature=-0.7,
size=1,
arrow=arrow(length=unit(0.1,"inches")),
color="darkgreen")+
geom_curve(data=subset(map_sum,locroot=="Argentina"&trans%in%c("Argentina to Peru")),
aes(x=lat1,y=lon1,
xend=lat2,yend=lon2),
curvature=0.7,
size=1,
arrow=arrow(length=unit(0.1,"inches")),
color="red")+
geom_label(data=coord,aes(x=latitude,y=longitude,label=Country),nudge_y=-5,alpha=0.5,size=3,label.padding=unit(0.1,"lines"))+
theme_map()+
theme(legend.position="none")
p_worlds<-ggarrange(world1,world2,ncol=1,nrow=2)
View(map_sum)
write.table("Summary_of_transitions.tsv",sep="\t",row.names=F,quotes=F)
write.table("Summary_of_transitions.tsv",sep="\t",row.names=F,quote=F)
write.table(map_sum,"Summary_of_transitions.tsv",sep="\t",row.names=F,quote=F)
#10:figure of the Maximum Clade Credibility tree####
#arrange the data
args<-c("16_v2tree_location_MCT_Arg.trees","16_v2tree_location_MCT_Per.trees","sample_v2_16.tsv","Summary_of_transitions.tsv")
library(ggplot2)
library(ggtree)
library(treeio)
library(ggpubr)
theme_set(theme_bw(base_size=15))
Sys.setlocale("LC_TIME", "English")
colors<-c("#cbcbf7","#f7cbcb","#f7f4cb","thistle1","#91e3db","#abc4d9","#9c9181","aquamarine4","#a9c7af","#99a5d6","#f4b771","#ec74dc","#9ed5ff","#dedede")
count_colors<-c("Argentina"="dodgerblue","Chile"="forestgreen","Peru"="firebrick","Colombia"="orangered","Ecuador"="goldenrod","Mexico"="darkmagenta")
#10:figure of the Maximum Clade Credibility tree####
#arrange the data
args<-c("16_v2tree_location_MCT_Arg.trees","16_v2tree_location_MCT_Per.trees","sample_v2_16.tsv","Summary_of_transitions.tsv")
#10:figure of the Maximum Clade Credibility tree####
#arrange the data
data<-read.csv(args[3],sep="\t")
data$date<-as.Date(data$date)
data_order<-data%>%
arrange(date)
tar<-read.beast(args[1])
tpe<-read.beast(args[2])
map_sum<-read.csv(args[4],sep="\t")
p_tpe<-ggtree(tpe,mrsd=data_order$date[nrow(data_order)],color="lightgrey")%<+%data_order
p_tar<-ggtree(tar,mrsd=data_order$date[nrow(data_order)],color="lightgrey")%<+%data_order
#select the most ancient and high supported nodes from each country
pernodes_list<-list()
for(i in levels(as.factor(p_tpe[["data"]]$Country))){
pernodes_list[[i]]<-p_tpe[["data"]]%>%
dplyr::filter(location==i)%>%
dplyr::mutate(CAheight_median=as.numeric(CAheight_median))%>%
dplyr::filter(CAheight_median==max(CAheight_median,na.rm=T))
}
pernodes<-do.call(rbind,pernodes_list)
argnodes_list<-list()
for(i in levels(as.factor(p_tar[["data"]]$Country))){
argnodes_list[[i]]<-p_tar[["data"]]%>%
dplyr::filter(location==i)%>%
dplyr::mutate(CAheight_median=as.numeric(CAheight_median))%>%
dplyr::filter(CAheight_median==max(CAheight_median,na.rm=T))
}
argnodes<-do.call(rbind,argnodes_list)
rootper<-Date2decimal(max(as.Date(p_tpe[["data"]]$date),na.rm=T))-as.numeric(p_tpe[["data"]]$height[p_tpe[["data"]]$node==p_tpe[["data"]]$parent])
receper<-Date2decimal(max(as.Date(p_tpe[["data"]]$date),na.rm=T))
p_tpe2<-p_tpe+
theme_tree2()+
geom_nodepoint(aes(color=location),size=1)+
geom_nodepoint(aes(subset=node%in%pernodes$node,color=location),size=5,shape=21,stroke=1.5)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
ggnewscale::new_scale_color()+
geom_tippoint(aes(color=location),size=1,shape=15)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
theme(axis.text.x=element_text(angle=90,hjust=0,vjust=0,size=10),
panel.grid.major=element_line(size=0.5),
legend.position="none",
legend.title=element_blank(),
legend.box="vertical",
legend.direction="vertical")+
ylim(c(-0.001,(length(tpe@phylo[["tip.label"]])+0.001)))+
scale_x_continuous(limits=c(rootper-0.08,receper),breaks=seq(2020,2022,0.1),labels=decimal2Date(seq(2020,2022,0.1)))+
annotate(geom="label",x=pernodes$x[pernodes$location=="Chile"]+0.20,y=pernodes$y[pernodes$location=="Chile"],color="forestgreen",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Peru"&map_sum$trans=="Peru to Chile"],
"-",
map_sum$q95date2[map_sum$locroot=="Peru"&map_sum$trans=="Peru to Chile"]))+
annotate(geom="label",x=pernodes$x[pernodes$location=="Argentina"]+0.20,y=pernodes$y[pernodes$location=="Argentina"],color="dodgerblue",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Peru"&map_sum$trans=="Peru to Argentina"],
"-",
map_sum$q95date2[map_sum$locroot=="Peru"&map_sum$trans=="Peru to Argentina"]))+
geom_taxalink(taxa1=pernodes$node[pernodes$location=="Peru"],taxa2=pernodes$node[pernodes$location=="Chile"],arrow=arrow(length=unit(0.2,"inches")),color="forestgreen")+
geom_taxalink(taxa1=pernodes$node[pernodes$location=="Peru"],taxa2=pernodes$node[pernodes$location=="Argentina"],arrow=arrow(length=unit(0.2,"inches")),color="dodgerblue")
rootarg<-Date2decimal(max(as.Date(p_tar[["data"]]$date),na.rm=T))-as.numeric(p_tar[["data"]]$height[p_tar[["data"]]$node==p_tar[["data"]]$parent])
recearg<-Date2decimal(max(as.Date(p_tar[["data"]]$date),na.rm=T))
p_tar2<-p_tar+
theme_tree2()+
geom_nodepoint(aes(color=location),size=1)+
geom_nodepoint(aes(subset=node%in%argnodes$node,color=location),size=5,shape=21,stroke=1.5)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
ggnewscale::new_scale_color()+
geom_tippoint(aes(color=location),size=1,shape=15)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
theme(axis.text.x=element_text(angle=90,hjust=0,vjust=0,size=10),
panel.grid.major=element_line(size=0.5),
legend.position="none",
legend.title=element_blank(),
legend.box="vertical",
legend.direction="vertical")+
ylim(c(-0.001,(length(tpe@phylo[["tip.label"]])+0.001)))+
scale_x_continuous(limits=c(rootarg-0.08,recearg),breaks=seq(2020,2022,0.1),labels=decimal2Date(seq(2020,2022,0.1)))+
annotate(geom="label",x=argnodes$x[argnodes$location=="Chile"]+0.20,y=argnodes$y[argnodes$location=="Chile"],color="forestgreen",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Argentina"&map_sum$trans=="Peru to Chile"],
"-",
map_sum$q95date2[map_sum$locroot=="Argentina"&map_sum$trans=="Peru to Chile"]))+
annotate(geom="label",x=argnodes$x[argnodes$location=="Peru"]+0.20,y=argnodes$y[argnodes$location=="Peru"],color="firebrick",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Argentina"&map_sum$trans=="Argentina to Peru"],
"-",
map_sum$q95date2[map_sum$locroot=="Argentina"&map_sum$trans=="Argentina to Peru"]))+
geom_taxalink(taxa1=argnodes$node[argnodes$location=="Argentina"],taxa2=argnodes$node[argnodes$location=="Peru"],arrow=arrow(length=unit(0.2,"inches")),color="firebrick")+
geom_taxalink(taxa1=argnodes$node[argnodes$location=="Peru"],taxa2=argnodes$node[argnodes$location=="Chile"],arrow=arrow(length=unit(0.2,"inches")),color="forestgreen")+
annotation_custom(grob=ggplotGrob(world2),
ymin=100,ymax=200,
xmin=rootarg-0.10,xmax=rootarg+0.10)
rootarg<-Date2decimal(max(as.Date(p_tar[["data"]]$date),na.rm=T))-as.numeric(p_tar[["data"]]$height[p_tar[["data"]]$node==p_tar[["data"]]$parent])
recearg<-Date2decimal(max(as.Date(p_tar[["data"]]$date),na.rm=T))
p_tar2<-p_tar+
theme_tree2()+
geom_nodepoint(aes(color=location),size=1)+
geom_nodepoint(aes(subset=node%in%argnodes$node,color=location),size=5,shape=21,stroke=1.5)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
ggnewscale::new_scale_color()+
geom_tippoint(aes(color=location),size=1,shape=15)+
scale_color_manual(values=count_colors[names(count_colors)%in%c("Argentina","Peru","Chile")])+
theme(axis.text.x=element_text(angle=90,hjust=0,vjust=0,size=10),
panel.grid.major=element_line(size=0.5),
legend.position="none",
legend.title=element_blank(),
legend.box="vertical",
legend.direction="vertical")+
ylim(c(-0.001,(length(tpe@phylo[["tip.label"]])+0.001)))+
scale_x_continuous(limits=c(rootarg-0.08,recearg),breaks=seq(2020,2022,0.1),labels=decimal2Date(seq(2020,2022,0.1)))+
annotate(geom="label",x=argnodes$x[argnodes$location=="Chile"]+0.20,y=argnodes$y[argnodes$location=="Chile"],color="forestgreen",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Argentina"&map_sum$trans=="Peru to Chile"],
"-",
map_sum$q95date2[map_sum$locroot=="Argentina"&map_sum$trans=="Peru to Chile"]))+
annotate(geom="label",x=argnodes$x[argnodes$location=="Peru"]+0.20,y=argnodes$y[argnodes$location=="Peru"],color="firebrick",alpha=0.5,
size=3,
label=paste(map_sum$q05date2[map_sum$locroot=="Argentina"&map_sum$trans=="Argentina to Peru"],
"-",
map_sum$q95date2[map_sum$locroot=="Argentina"&map_sum$trans=="Argentina to Peru"]))+
geom_taxalink(taxa1=argnodes$node[argnodes$location=="Argentina"],taxa2=argnodes$node[argnodes$location=="Peru"],arrow=arrow(length=unit(0.2,"inches")),color="firebrick")+
geom_taxalink(taxa1=argnodes$node[argnodes$location=="Peru"],taxa2=argnodes$node[argnodes$location=="Chile"],arrow=arrow(length=unit(0.2,"inches")),color="forestgreen")
pfin<-ggarrange(p_tpe2,p_tar2,ncol=1,nrow=2)%>%
annotate_figure(left=text_grob("Location root",rot=90))
ggsave("MCC_trees_of_Lambda_origin.jpg",plot=pfin,dpi=500,height=7.5,width=10)
ggsave("MCC_trees_of_Lambda_origin.jpg",plot=pfin,dpi=500,height=7.5,width=7)
rootpe<-ggarrange(p_tpe2,ncol=1,nrow=1)%>%
annotate_figure(left=text_grob("Peru",rot=90))
rootar<-ggarrange(p_tar2,ncol=1,nrow=1)%>%
annotate_figure(left=text_grob("Argentina",rot=90))
pfin<-ggarrange(p_tpe2,p_tar2,ncol=1,nrow=2)%>%
annotate_figure(left=text_grob("Location root",rot=90))
rootpe<-ggarrange(p_tpe2,ncol=1,nrow=1)%>%
annotate_figure(left=text_grob("Peru",rot=90))
rootar<-ggarrange(p_tar2,ncol=1,nrow=1)%>%
annotate_figure(left=text_grob("Argentina",rot=90))
pfin<-ggarrange(p_tpe2,p_tar2,ncol=1,nrow=2)%>%
annotate_figure(left=text_grob("Location root",rot=90))
ggsave("MCC_trees_of_Lambda_origin.jpg",plot=pfin,dpi=500,height=7.5,width=7)
pfin<-ggarrange(rootpe,rootar,ncol=1,nrow=2)%>%
annotate_figure(left=text_grob("Location root",rot=90))
ggsave("MCC_trees_of_Lambda_origin.jpg",plot=pfin,dpi=500,height=7.5,width=7)
args<-c("sample_v2_16f.log")
#2:load libraries and establish settings####
library(ggplot2)
theme_set(theme_bw(base_size=15))
Sys.setlocale("LC_TIME", "English")
args<-c("sample_v2_16f.log")
#3:Read files####
t<-read.csv(args[1],sep"\t",comment.char="#")
#3:Read files####
t<-read.csv(args[1],sep="\t",comment.char="#")
View(t)
t<-read.csv(args[1],sep="\t",comment.char="#")%>%
dplyr::select(7)
View(t)
t<-read.csv(args[1],sep="\t",comment.char="#")%>%
dplyr::select(clock_rate=7)
ggplot(t,aes(x=clock_rate))+
geom_density()
ggplot(t,aes(x=clock_rate))+
geom_density()+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
#3:Read files####
files<-dir(pattern="*f.log")
files
files<-dir(pattern="*f.log")
t_list<-list()
for(i in files){
t_list[[as.character(i)]]<-read.csv(files[i],sep="\t",comment.char="#")%>%
dplyr::select(clock_rate=7)%>%
dplyr::mutate(sample=i)
}
files<-dir(pattern="*f.log")
t_list<-list()
for(i in 1:length(files)){
t_list[[as.character(i)]]<-read.csv(files[i],sep="\t",comment.char="#")%>%
dplyr::select(clock_rate=7)%>%
dplyr::mutate(sample=i)
}
t<-do.call(rbind,t_list)
ggplot(t,aes(x=clock_rate,fill=sample))+
geom_density()+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
View(t)
ggplot(t,aes(x=clock_rate))+
geom_density(aes(color=sample))+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
View(t)
ggplot(t,aes(x=clock_rate))+
geom_density(aes(color=sample))
View(t)
files
t_list<-list()
for(i in 1:length(files)){
t_list[[as.character(i)]]<-read.csv(files[i],sep="\t",comment.char="#")%>%
dplyr::select(clock_rate=7)%>%
dplyr::mutate(sample=i)
}
View(t_list)
View(t)
files<-dir(pattern="*f.log")
t_list<-list()
for(i in 1:length(files)){
t_list[[as.character(i)]]<-read.csv(files[i],sep="\t",comment.char="#")}
View(t_list)
View(t_list[["1"]])
View(t_list[["2"]])
names(t)
t<-read.csv(files[2],sep="\t",comment.char="#")
names(t)
names(t)[grepl("clockRate",names(t))]
t<-read.csv(files[2],sep="\t",comment.char="#")
t<-t%>%
dplyr::select(clock_rate=names(t)[grepl("clockRate",names(t))])%>%
dplyr::mutate(sample=i)
View(t)
files<-dir(pattern="*f.log")
t_list<-list()
for(i in 1:length(files)){
t<-read.csv(files[i],sep="\t",comment.char="#")
t_list[[as.character(i)]]<-t%>%
dplyr::select(clock_rate=names(t)[grepl("clockRate",names(t))])%>%
dplyr::mutate(sample=i)
}
t<-do.call(rbind,t_list)
ggplot(t,aes(x=clock_rate))+
geom_density(aes(color=sample))+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
ggplot(t,aes(x=clock_rate))+
geom_density(aes(fill=sample))+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
ggplot(t,aes(x=clock_rate))+
geom_density(aes(fill=sample))
ggplot(t,aes(x=clock_rate,fill=sample))+
geom_density(aes())
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(aes())
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density()+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
library(ggplot2)
theme_set(theme_bw(base_size=15))
Sys.setlocale("LC_TIME", "English")
colors<-c("#cbcbf7","#f7cbcb","#f7f4cb","thistle1","#91e3db","#abc4d9","#9c9181","aquamarine4","#a9c7af","#99a5d6","#f4b771","#ec74dc","#9ed5ff","#dedede")
count_colors<-c("Argentina"="dodgerblue","Chile"="forestgreen","Peru"="firebrick","Colombia"="orangered","Ecuador"="goldenrod","Mexico"="darkmagenta")
setwd("I:/Mi unidad/Santiago/BIO_INF_TEC_URP/hCoV/Proyecto_hCoV/Peruvian_analysis/final_NC/2_Lambda_origin/2_3_Phylodynamic_analysis")
files<-dir(pattern="*f.log")
t_list<-list()
for(i in 1:length(files)){
t<-read.csv(files[i],sep="\t",comment.char="#")
t_list[[as.character(i)]]<-t%>%
dplyr::select(clock_rate=names(t)[grepl("clockRate",names(t))])%>%
dplyr::mutate(sample=i)
}
library(dplyr)
files<-dir(pattern="*f.log")
t_list<-list()
for(i in 1:length(files)){
t<-read.csv(files[i],sep="\t",comment.char="#")
t_list[[as.character(i)]]<-t%>%
dplyr::select(clock_rate=names(t)[grepl("clockRate",names(t))])%>%
dplyr::mutate(sample=i)
}
t<-do.call(rbind,t_list)
count_colors<-c("Argentina"="dodgerblue","Chile"="forestgreen","Peru"="firebrick")
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density()+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.2)+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())+
scale_fill_manual(values=colors)
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.5)+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())+
scale_fill_manual(values=colors)
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.5)+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.4)+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.3)+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank())+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.3)+
labs(x="Clock rate (s/s/y)",fill="sample")+
theme(axis.title.y=element_blank(),
legend.position="botton")+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))+
guides(fill=guide_legend(nrow=1))
ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.3)+
labs(x="Clock rate (s/s/y)",fill="sample")+
theme(axis.title.y=element_blank(),
legend.position="bottom")+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))+
guides(fill=guide_legend(nrow=1))
p_clock<-ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.3)+
labs(x="Clock rate (s/s/y)",fill="sample")+
theme(axis.title.y=element_blank(),
legend.position="bottom")+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))+
guides(fill=guide_legend(nrow=1))
ggsave("Clock_rate_distribution.jpg",plot=p_clock,dpi=500,height=5,width=5)
#3:Read files####
files<-args[1]
files<-files[1]
t_list<-list()
for(i in 1:length(files)){
t<-read.csv(files[i],sep="\t",comment.char="#")
t_list[[as.character(i)]]<-t%>%
dplyr::select(clock_rate=names(t)[grepl("clockRate",names(t))])%>%
dplyr::mutate(sample=i)
}
t<-do.call(rbind,t_list)
p_clock<-ggplot(t,aes(x=clock_rate,fill=as.factor(sample)))+
geom_density(alpha=0.3)+
labs(x="Clock rate (s/s/y)",fill="sample")+
theme(axis.title.y=element_blank(),
legend.position="bottom")+
scale_fill_manual(values=c("forestgreen","dodgerblue","firebrick"))+
guides(fill=guide_legend(nrow=1))
p_clock
p_clock<-ggplot(t,aes(x=clock_rate))+
geom_density(alpha=0.3,fill="forestgreen")+
labs(x="Clock rate (s/s/y)")+
theme(axis.title.y=element_blank(),
legend.position="none")
p_clock
