angle=45,
size=5,
fontface="bold")+
ylim(c(-5,length(t_grouped@phylo[["tip.label"]])+10))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
p_leg<-ggtree(t_grouped,aes(color=SubGsT),show.legend=F)%<+%d+
scale_color_manual(values=c("lightgrey","lightcyan2","bisque3","darkkhaki"))+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[1])),color="darkblue",nudge_x=-0.00009,nudge_y=25)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[1])),color="darkblue",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[2])),color="darkred",nudge_x=-0.00009,nudge_y=25)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[2])),color="darkred",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[3])),color="gold4",nudge_x=-0.00009,nudge_y=25)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[3])),color="gold4",shape=15,size=4)+
theme(legend.position="bottom")+
guides(fill=guide_legend(nrow=1))+
new_scale_color()
msap<-msaplot(p_leg,sequences,height=1,color=c("darkseagreen1","lightblue3","gray26","white","white","white","rosybrown2","white"))+
scale_fill_manual(values=c("darkseagreen1","lightblue3","gray26","white","white","white","rosybrown2","white"),name="Base",labels=c("A","C","G","N","N","N","T","N"))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=seq(0.0013,0.0013+0.000225*5,0.000225),
y=length(t_grouped@phylo[["tip.label"]])+20,
label=c("3049","10116","22298","23599","23604","25613"),
angle=45,
size=5,
fontface="bold")+
ylim(c(-5,length(t_grouped@phylo[["tip.label"]])+20))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.0013,0.0013+0.000225*5,0.000225),
y=length(t_grouped@phylo[["tip.label"]])+40,
label=c("3049","10116","22298","23599","23604","25613"),
angle=45,
size=5,
fontface="bold")+
ylim(c(-2,length(t_grouped@phylo[["tip.label"]])+40))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.0013,0.0013+0.000225*5,0.000225),
y=length(t_grouped@phylo[["tip.label"]])+60,
label=c("3049","10116","22298","23599","23604","25613"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+60))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.0013,0.0013+0.000225*5,0.000225),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("3049","10116","22298","23599","23604","25613"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
p_leg<-ggtree(t_grouped,aes(color=SubGsT),show.legend=F)%<+%d+
scale_color_manual(values=c("lightgrey","lightcyan2","bisque3","darkkhaki"))+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[1])),color="darkblue",nudge_x=-0.00009,nudge_y=30)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[1])),color="darkblue",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[2])),color="darkred",nudge_x=-0.00009,nudge_y=30)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[2])),color="darkred",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[3])),color="gold4",nudge_x=-0.00009,nudge_y=30)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[3])),color="gold4",shape=15,size=4)+
theme(legend.position="bottom")+
guides(fill=guide_legend(nrow=1))+
new_scale_color()
msap<-msaplot(p_leg,sequences,height=1,color=c("darkseagreen1","lightblue3","gray26","white","white","white","rosybrown2","white"))+
scale_fill_manual(values=c("darkseagreen1","lightblue3","gray26","white","white","white","rosybrown2","white"),name="Base",labels=c("A","C","G","N","N","N","T","N"))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=seq(0.0013,0.0013+0.000225*5,0.000225),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("3049","10116","22298","23599","23604","25613"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Gamma.jpg",plot=msapf,dpi=300,height=7.5,width=10)
View(sequences)
#3:read files####
args<-c("Lambda_good_seqs.fasta.treefile","nexclean_Peru_Var.tsv","Lambda_good_seqs_spec_sites.fasta")
#read the maximum likelihoood tree
t<-read.iqtree(args[1])
d<-read.csv(args[2],sep="\t")%>%
dplyr::filter(name_analysis%in%t@phylo[["tip.label"]])%>%
mutate(date=as.Date(date))
#read the fasta of the selected positions
sequences<-read.fasta(args[3])
View(sequences)
View(sequences)
sequences[["EPI_ISL_5764159"]]
sequences[["EPI_ISL_5764159"]][1]
sequences[["EPI_ISL_5764159"]][2]
sequences[["EPI_ISL_5764159"]][2]<-"t"
sequences[["EPI_ISL_5764159"]][[1]]
sequences[["EPI_ISL_5764159"]][[2]]
sequences[["EPI_ISL_5764159"]][[1]]
sequences[["EPI_ISL_576415"]][[1]]
sequences[["EPI_ISL_3940281"]]
sequences[["EPI_ISL_3940281"]][[1]]
sequences[["EPI_ISL_3670626"]][[1]]
sequences[["EPI_ISL_4080316"]][[1]]
sequences[["EPI_ISL_5764159"]][2]
sequences[["EPI_ISL_5764159"]][2]<-28
sequences[["EPI_ISL_5764159"]][[1]]
typeof(sequences[["EPI_ISL_5764159"]][[1]])
seqs<-ape::read.FASTA(args[3])
View(seqs)
seqs[["EPI_ISL_5764159"]]
seqs[["EPI_ISL_5764159"]][1]
seqs[["EPI_ISL_5764159"]][2]
seqs[["EPI_ISL_5764159"]][2]<-28
seqs[["EPI_ISL_5764159"]][2]<-as.raw(28)
seqs[["EPI_ISL_5764159"]]
seqs[["EPI_ISL_5764159"]][3]<-as.raw(28)
seqs[["EPI_ISL_5764159"]]
sequences[["EPI_ISL_5764159"]][2]<-as.raw(28)
sequences[["EPI_ISL_5764159"]]
View(sequences)
p_t<-ggtree(t,color="lightgrey")%<+%d
r_node<-p_t[["data"]]$parent[p_t[["data"]]$node==p_t[["data"]]$parent]
nodes<-p_t[["data"]]%>%
dplyr::filter(isTip==FALSE&node!=r_node&SH_aLRT>=70&UFboot>=70)
sel_nodes<-c()
tips<-list()
for(i in 1:nrow(nodes)){
print(i)
t1<-tree_subset(t,node=nodes$node[i],levels_back=0)
if(length(t1@phylo[["tip.label"]])>=400){
tips[[as.character(nodes$node[i])]]<-t1@phylo[["tip.label"]]
sel_nodes<-append(sel_nodes,nodes$node[i])
}
}
sequences[["EPI_ISL_5764159"]][1]<-sequences[["EPI_ISL_5764159"]][1]
View(sequences)
sequences[["EPI_ISL_5934945"]]
i=1
sequences[[i]]
sequences<-read.fasta(args[3])
for(i in 1:length(sequences)){
sequences[[i]][2]<-sequences[[i]][1]
sequences[[i]][1]<-sequences[["EPI_ISL_5934945"]][1]
sequences[[i]][3]<-sequences[["EPI_ISL_5934945"]][1]
}
sel_lins<-list()
for(i in 1:length(sel_nodes)){
print(i)
if(i!=length(sel_nodes)){
test_tips<-tips[[i]][!(tips[[i]]%in%tips[[i+1]])]
}else{
test_tips<-tips[[i]]
}
if(length(test_tips)>=400){
sel_lins[[as.character(sel_nodes[i])]]<-test_tips
}
}
t_grouped<-t%>%
groupOTU(sel_lins,group_name="SubLsT")
t_grouped@phylo[["tip.label"]]<-sapply(strsplit(t_grouped@phylo[["tip.label"]],"\\|"),"[",1)
p_leg<-ggtree(t_grouped,aes(color=SubLsT),show.legend=F)%<+%d+
scale_color_manual(values=c("lightgrey","#58578a","#8ad3db"))+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",nudge_x=-0.00009,nudge_y=20)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",nudge_x=-0.00009,nudge_y=20)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",shape=15,size=4)+
theme(legend.position="bottom")+
guides(color=guide_legend(nrow=1))+
new_scale_color()
p_leg
msap<-msaplot(p_leg,sequences)
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","gray26","rosybrown2","white"))+
scale_fill_manual(values=c("white","lightblue3","gray26","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","gray26","rosybrown2","white"))+
scale_fill_manual(values=c("white","lightblue3","gray26","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(2,2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(2,3))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
View(sequences)
msap<-msaplot(p_leg,sequences)
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(2,3))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","lightblue3","rosybrown2","white"),window=c(2,3))+
scale_fill_manual(values=c("lightblue3","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
sequences<-read.fasta(args[3])
for(i in 1:length(sequences)){
sequences[[i]][2]<-sequences[["EPI_ISL_5934945"]][1]
sequences[[i]][3]<-sequences[["EPI_ISL_5934945"]][1]
}
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","lightblue3","rosybrown2","white"),window=c(2,3))+
scale_fill_manual(values=c("lightblue3","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
View(sequences)
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","lightblue3","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("lightblue3","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base",labels=c("N","C","T","N"))+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("white","lightblue3","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("white","lightblue3","rosybrown2","white"),name="Base")+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base")+
theme(legend.title = element_text(face = "bold"))
msap
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base",labels=c("C","","T",""))+
theme(legend.title = element_text(face = "bold"))
msap
msapf<-msap+
annotate("text",
x=seq(0.0013),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("Maximum_likelihood_Lambda.jpg",plot=p_t_fin_lam,dpi=500,height=5,width=5)
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2))+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base",labels=c("C","","T",""))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=seq(0.0013),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("Maximum_likelihood_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.0002),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.000001),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=seq(0.0000000001),
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
seq(0.0000000001)
msapf<-msap+
annotate("text",
x=0.0000000001,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.00001,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.001,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.02))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.002))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.005))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.0025))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2),width=0.25)+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base",labels=c("C","","T",""))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.0025))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.001))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.0015))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.002,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.002))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.001,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.0015,
y=length(t_grouped@phylo[["tip.label"]])+70,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+70))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
p_leg<-ggtree(t_grouped,aes(color=SubLsT),show.legend=F)%<+%d+
scale_color_manual(values=c("lightgrey","#58578a","#8ad3db"))+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",nudge_x=-0.00008,nudge_y=25)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",nudge_x=-0.00008,nudge_y=25)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",shape=15,size=4)+
theme(legend.position="bottom")+
guides(color=guide_legend(nrow=1))+
new_scale_color()
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2),width=0.25)+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base",labels=c("C","","T",""))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=0.00125,
y=length(t_grouped@phylo[["tip.label"]])+100,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+100))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.0013,
y=length(t_grouped@phylo[["tip.label"]])+150,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+150))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
p_leg<-ggtree(t_grouped,aes(color=SubLsT),show.legend=F)%<+%d+
scale_color_manual(values=c("lightgrey","#58578a","#8ad3db"))+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",nudge_x=-0.00008,nudge_y=40)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[1])),color="#58578a",shape=15,size=4)+
geom_nodelab(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",nudge_x=-0.00008,nudge_y=40)+
geom_nodepoint(aes(subset=node==as.numeric(names(sel_lins)[2])),color="#8ad3db",shape=15,size=4)+
theme(legend.position="bottom")+
guides(color=guide_legend(nrow=1))+
new_scale_color()
msap<-msaplot(p_leg,sequences,height=1,color=c("lightblue3","white","rosybrown2","white"),window=c(1,2),width=0.25)+
scale_fill_manual(values=c("lightblue3","white","rosybrown2","white"),name="Base",labels=c("C","","T",""))+
theme(legend.title = element_text(face = "bold"))
msapf<-msap+
annotate("text",
x=0.00135,
y=length(t_grouped@phylo[["tip.label"]])+150,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+150))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
msapf<-msap+
annotate("text",
x=0.0014,
y=length(t_grouped@phylo[["tip.label"]])+150,
label=c("28849"),
angle=45,
size=5,
fontface="bold")+
ylim(c(0,length(t_grouped@phylo[["tip.label"]])+150))+
xlim(c(0,0.00175))
ggsave("msa_tree_Lambda.jpg",plot=msapf,dpi=500,height=7.5,width=10)
